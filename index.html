<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard by Dino</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Hamburger Menu Button -->
    <button class="hamburger-btn" id="hamburger-btn" onclick="toggleSidebar()">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
    </button>

    <!-- User Login/Profile Button -->
    <button class="user-login-btn" id="user-login-btn" onclick="handleUserBtnClick()">
        <span id="user-btn-icon">üë§</span>
    </button>

    <!-- Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="close-sidebar-btn" onclick="closeSidebar()"></button>
        </div>
        <nav class="sidebar-nav">
            <button class="nav-btn active" onclick="showSection('library'); closeSidebar()">
                <span class="nav-icon">üìö </span>
                Th∆∞ vi·ªán c·ªßa b·∫°n
            </button>
            <button class="nav-btn" onclick="showSection('create'); closeSidebar()">
                <span class="nav-icon">‚ú®</span>
                T·∫°o th·∫ª m·ªõi
            </button>
        </nav>
        <div class="sidebar-footer">
            <p>Made by ‚ù§Ô∏è Dino</p>
        </div>
    </div>

    <div class="main">

        <div id="library" class="section">
            <h1>Th∆∞ vi·ªán c·ªßa b·∫°n</h1>
            <div id="deck-list" class="deck-grid">
            </div>
            <p id="empty-msg" style="text-align:center; margin-top:50px; color:#888;">Ch∆∞a c√≥ h·ªçc ph·∫ßn n√†o. H√£y t·∫°o m·ªõi!
            </p>
        </div>


        <div id="create" class="section hidden">
            <h1>T·∫°o th·∫ª m·ªõi</h1>
            <div class="input-group">
                <input type="text" id="deck-title" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ"
                    style="font-size: 18px; font-weight: bold;">
                <br>
                <div style="margin-top: 10px;">
                    <label>Nh·∫≠p nhanh t·ª´ vƒÉn b·∫£n (ƒê·ªãnh d·∫°ng: Thu·∫≠t ng·ªØ - ƒê·ªãnh nghƒ©a):</label>
                    <textarea id="import-text" rows="3" placeholder="Apple - Qu·∫£ t√°o&#10;Book - Quy·ªÉn s√°ch"></textarea>
                    <button class="btn btn-secondary" onclick="importText()">Nh·∫≠p d·ªØ li·ªáu</button>
                </div>
            </div>

            <div id="card-list-builder">
            </div>

            <button class="btn" onclick="addCardInput()">Th√™m th·∫ª</button>
            <hr>
            <button class="btn btn-primary-large" id="save-deck-btn" onclick="saveDeck()">T·∫°o h·ªçc ph·∫ßn</button>
        </div>

        <div id="study" class="section hidden">
            <div class="header-actions" style="z-index: 100; margin-top: 40px;">
                <button class="btn btn-secondary" onclick="showSection('library')">‚Üê Quay l·∫°i</button>
                <h2 id="study-title" style="text-align: center; flex: 1; margin: 0 10px;"></h2>
                <div style="position: relative; display: flex; gap: 10px;">
                    <button class="menu-btn" onclick="openSettings()">‚öôÔ∏è</button>
                    <button class="menu-btn" onclick="toggleMenu()">‚ãÆ</button>
                    <div class="dropdown-menu" id="study-menu">
                        <div class="dropdown-item" onclick="editDeckAction()"><span>‚úèÔ∏è</span> S·ª≠a th·∫ª</div>
                        <div class="dropdown-item" onclick="duplicateDeckAction()"><span>üìÑ</span> T·∫°o b·∫£n sao</div>
                        <div class="dropdown-item" onclick="printDeckAction()"><span>üñ®Ô∏è</span> In</div>
                        <div class="dropdown-item" onclick="mergeDeckAction()"><span>üîó</span> Gh√©p b√†i</div>
                        <div class="dropdown-item" onclick="exportDeckAction()"><span>üì§</span> Xu·∫•t</div>
                        <div class="dropdown-item" onclick="embedDeckAction()"><span>üìÅ</span> Nh√∫ng</div>
                        <div class="dropdown-item" style="color: #ef4444;" onclick="deleteDeckAction()"><span>üóëÔ∏è</span>
                            X√≥a</div>
                    </div>
                </div>
            </div>

            <!-- Progress Counter -->
            <div class="progress-container" id="progress-container">
                <div class="progress-stats">
                    <span class="stat-known">‚úÖ ƒê√£ bi·∫øt: <strong id="known-count">0</strong></span>
                    <span class="stat-unknown">‚ùå Ch∆∞a bi·∫øt: <strong id="unknown-count">0</strong></span>
                    <span class="stat-total">üìä T·ªïng: <strong id="total-count">0</strong></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>

            <div class="mode-controls" id="mode-controls">
                <span class="mode-label">üéÆ Ch·∫ø ƒë·ªô h·ªçc: </span>
                <div class="mode-buttons">
                    <button class="btn mode-btn" onclick="startMode('flashcard')">üÉè Flashcard</button>
                    <button class="btn mode-btn" onclick="startMode('quiz')">üìù Tr·∫Øc nghi·ªám</button>
                    <button class="btn mode-btn" onclick="startMode('write')">‚úçÔ∏è Vi·∫øt l·∫°i</button>
                    <button class="btn mode-btn" onclick="startMode('truefalse')">‚úîÔ∏è ƒê√∫ng/Sai</button>
                    <button class="btn mode-btn" onclick="startMode('match')">üß© Gh√©p th·∫ª</button>
                    <button class="btn mode-btn btn-rainbow" onclick="startMode('random')">üé≤ Ki·ªÉm tra ng·∫´u
                        nhi√™n</button>
                </div>
            </div>

            <div id="active-mode-header" class="hidden" style="margin-bottom: 20px;">
                <button class="btn btn-secondary" onclick="exitStudyMode()">‚Üê Quay l·∫°i ch·ªçn ch·∫ø ƒë·ªô</button>
            </div>

            <div id="game-area">
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="sidebar-overlay" id="settings-modal"
        style="z-index: 2000; transition: all 0.3s; display: flex; align-items: center; justify-content: center;">
        <div class="modal-content"
            style="background: var(--bg-card); padding: 30px; border-radius: 16px; width: 95%; max-width: 700px; position: relative;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0;">‚öôÔ∏è C√†i ƒë·∫∑t</h2>
                <button class="btn btn-secondary" onclick="closeSettings()" style="padding: 8px 15px;">‚úï</button>
            </div>

            <div class="settings-sections">
                <div class="settings-section">
                    <h3 class="section-title">üìä S·ªë l∆∞·ª£ng & V√≤ng ch∆°i</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label>V√≤ng ch∆°i (Gh√©p th·∫ª):</label>
                            <input type="number" id="set-match-rounds" min="1" max="10" value="1">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë c·∫∑p th·∫ª (T·ªëi ƒëa 6):</label>
                            <input type="number" id="set-match-count" min="2" max="6" value="6">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë c√¢u Tr·∫Øc nghi·ªám:</label>
                            <input type="number" id="set-quiz-count" min="1" value="10">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë c√¢u Vi·∫øt l·∫°i:</label>
                            <input type="number" id="set-write-count" min="1" value="10">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë c√¢u ƒê√∫ng/Sai:</label>
                            <input type="number" id="set-tf-count" min="1" value="10">
                        </div>
                        <div class="setting-item">
                            <label>S·ªë c√¢u Ng·∫´u nhi√™n:</label>
                            <input type="number" id="set-random-count" min="1" max="50" value="10">
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="section-title">‚å®Ô∏è Ph√≠m t·∫Øt b√†n ph√≠m</h3>
                    <div class="shortcuts-container">
                        <div class="shortcut-group">
                            <h4>üÉè Flashcard</h4>
                            <div class="shortcut-item">
                                <span>ƒê√£ bi·∫øt:</span>
                                <button class="shortcut-btn" id="sc-fc-known"
                                    onclick="captureHotkey('fc-known')">ArrowRight</button>
                            </div>
                            <div class="shortcut-item">
                                <span>Ch∆∞a bi·∫øt:</span>
                                <button class="shortcut-btn" id="sc-fc-unknown"
                                    onclick="captureHotkey('fc-unknown')">ArrowLeft</button>
                            </div>
                            <div class="shortcut-item">
                                <span>L·∫≠t th·∫ª:</span>
                                <button class="shortcut-btn" id="sc-fc-flip"
                                    onclick="captureHotkey('fc-flip')">Space</button>
                            </div>
                        </div>

                        <div class="shortcut-group">
                            <h4>‚úîÔ∏è ƒê√∫ng/Sai</h4>
                            <div class="shortcut-item">
                                <span>ƒê√∫ng:</span>
                                <button class="shortcut-btn" id="sc-tf-true"
                                    onclick="captureHotkey('tf-true')">ArrowLeft</button>
                            </div>
                            <div class="shortcut-item">
                                <span>Sai:</span>
                                <button class="shortcut-btn" id="sc-tf-false"
                                    onclick="captureHotkey('tf-false')">ArrowRight</button>
                            </div>
                            <div class="shortcut-item">
                                <span>Ti·∫øp theo:</span>
                                <button class="shortcut-btn" id="sc-tf-next"
                                    onclick="captureHotkey('tf-next')">Enter</button>
                            </div>
                        </div>

                        <div class="shortcut-group">
                            <h4>‚úçÔ∏è Vi·∫øt l·∫°i</h4>
                            <div class="shortcut-item">
                                <span>Ti·∫øp theo:</span>
                                <button class="shortcut-btn" id="sc-w-next"
                                    onclick="captureHotkey('w-next')">Enter</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeSettings()">H·ªßy</button>
                <button class="btn" onclick="saveSettings()">L∆∞u thay ƒë·ªïi</button>
            </div>
        </div>
    </div>

    <!-- Auth Overlay -->
    <div id="auth-overlay" class="auth-overlay hidden">
        <div class="auth-card" style="position: relative;">
            <button class="close-auth-btn"
                onclick="document.getElementById('auth-overlay').classList.add('hidden')">‚úï</button>
            <h1 class="auth-title">Flashcard Dino ü¶ï</h1>
            <p class="auth-subtitle">ƒêƒÉng nh·∫≠p ƒë·ªÉ l∆∞u v√† ƒë·ªìng b·ªô d·ªØ li·ªáu c·ªßa b·∫°n m·ªçi n∆°i.</p>

            <!-- Error Message -->
            <div id="auth-error" class="auth-error hidden"></div>

            <!-- Login Form -->
            <div id="login-section">
                <form onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="login-username" required placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p">
                    </div>
                    <div class="form-group">
                        <label>M·∫≠t kh·∫©u</label>
                        <div class="password-wrapper">
                            <input type="password" id="login-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            <span class="toggle-icon" onclick="togglePassword('login-password', this)">üëÅÔ∏è</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary-large" style="margin-top: 10px;">ƒêƒÉng nh·∫≠p</button>
                </form>
                <div class="auth-footer">
                    Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="toggleAuthMode()">ƒêƒÉng k√Ω ngay</a>
                </div>
            </div>

            <!-- Register Form -->
            <div id="register-section" class="hidden">
                <form onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label>T√™n ƒëƒÉng nh·∫≠p</label>
                        <input type="text" id="reg-username" required placeholder="Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p">
                    </div>
                    <div class="form-group">
                        <label>M·∫≠t kh·∫©u</label>
                        <div class="password-wrapper">
                            <input type="password" id="reg-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            <span class="toggle-icon" onclick="togglePassword('reg-password', this)">üëÅÔ∏è</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Nh·∫≠p l·∫°i m·∫≠t kh·∫©u</label>
                        <div class="password-wrapper">
                            <input type="password" id="reg-confirm-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            <span class="toggle-icon" onclick="togglePassword('reg-confirm-password', this)">üëÅÔ∏è</span>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary-large" style="margin-top: 10px;">ƒêƒÉng k√Ω</button>
                </form>
                <div class="auth-footer">
                    ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="toggleAuthMode()">ƒêƒÉng nh·∫≠p</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Config & Global State -->
    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/card.js"></script>
    <script src="js/library.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/setting.js"></script>
    <script src="js/event.js"></script>

    <!-- Study Modes -->
    <script src="js/modes/flashcard.js"></script>
    <script src="js/modes/quiz.js"></script>
    <script src="js/modes/write.js"></script>
    <script src="js/modes/truefalse.js"></script>
    <script src="js/modes/match.js"></script>
    <script src="js/modes/random.js"></script>

    <!-- Main Initializer -->
    <script src="js/main.js"></script>
</body>

</html>